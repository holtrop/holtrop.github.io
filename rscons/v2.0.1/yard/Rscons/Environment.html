<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Rscons::Environment
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Rscons::Environment";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (E)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Rscons.html" title="Rscons (module)">Rscons</a></span></span>
     &raquo; 
    <span class="title">Environment</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Rscons::Environment
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="BasicEnvironment.html" title="Rscons::BasicEnvironment (class)">BasicEnvironment</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="BasicEnvironment.html" title="Rscons::BasicEnvironment (class)">BasicEnvironment</a></span></li>
          
            <li class="next">Rscons::Environment</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rscons/environment.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The Environment class is the main programmatic interface to Rscons. It contains a collection of construction variables, options, builders, and rules for building targets.</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Class Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#environments-class_method" title="environments (class method)">.<strong>environments</strong>  &#x21d2; Array&lt;Environment&gt; </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>All Environments.</p>
</div></span>
  
</li>

    
  </ul>

  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_root-instance_method" title="#build_root (instance method)">#<strong>build_root</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The build root.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#builders-instance_method" title="#builders (instance method)">#<strong>builders</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set of {“builder_name” =&gt; builder_object} pairs.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#echo-instance_method" title="#echo (instance method)">#<strong>echo</strong>  &#x21d2; Symbol </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>:command, :short, or :off.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#n_threads-instance_method" title="#n_threads (instance method)">#<strong>n_threads</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The number of threads to use for this Environment.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#class_init-class_method" title="class_init (class method)">.<strong>class_init</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initialize class instance variables.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_id-class_method" title="get_id (class method)">.<strong>get_id</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get an ID for a new Environment.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register-class_method" title="register (class method)">.<strong>register</strong>(env)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Register an Environment.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_build_hook-instance_method" title="#add_build_hook (instance method)">#<strong>add_build_hook</strong> {|build_op| ... } &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a build hook to the Environment.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_builder-instance_method" title="#add_builder (instance method)">#<strong>add_builder</strong>(builder_class, &amp;action)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a <span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span> to the Environment.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_post_build_hook-instance_method" title="#add_post_build_hook (instance method)">#<strong>add_post_build_hook</strong> {|build_op| ... } &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a post build hook to the Environment.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#barrier-instance_method" title="#barrier (instance method)">#<strong>barrier</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Mark a “barrier” point.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_after-instance_method" title="#build_after (instance method)">#<strong>build_after</strong>(targets, prerequisites)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Manually record the given target(s) as needing to be built after the given prerequisite(s).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_steps_remaining-instance_method" title="#build_steps_remaining (instance method)">#<strong>build_steps_remaining</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the number of build steps remaining.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#builder_for-instance_method" title="#builder_for (instance method)">#<strong>builder_for</strong>(target)  &#x21d2; Builder<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the Builder for a target.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear_targets-instance_method" title="#clear_targets (instance method)">#<strong>clear_targets</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Clear all targets registered for the Environment.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clone-instance_method" title="#clone (instance method)">#<strong>clone</strong>(options = {})  &#x21d2; Environment </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Make a copy of the Environment object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#depends-instance_method" title="#depends (instance method)">#<strong>depends</strong>(target, *user_deps)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Manually record a given target as depending on the specified files.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#expand_path-instance_method" title="#expand_path (instance method)">#<strong>expand_path</strong>(path)  &#x21d2; String<sup>+</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Expand a path to be relative to the Environment&#39;s build root.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_build_fname-instance_method" title="#get_build_fname (instance method)">#<strong>get_build_fname</strong>(source_fname, suffix, builder_class)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return the file name to be built from <code>source_fname</code> with suffix <code>suffix</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_user_deps-instance_method" title="#get_user_deps (instance method)">#<strong>get_user_deps</strong>(target)  &#x21d2; Array&lt;String&gt;<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return the list of user dependencies for a given target.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(options = {})  &#x21d2; Environment </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create an Environment object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#method_missing-instance_method" title="#method_missing (instance method)">#<strong>method_missing</strong>(method, *args)  &#x21d2; Builder </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define a build target.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_builder_run_message-instance_method" title="#print_builder_run_message (instance method)">#<strong>print_builder_run_message</strong>(builder, short_description, command)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Print the builder run message, depending on the Environment&#39;s echo mode.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process-instance_method" title="#process (instance method)">#<strong>process</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Build all build targets specified in the Environment.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#produces-instance_method" title="#produces (instance method)">#<strong>produces</strong>(target, *side_effects)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Manually record the given side effect file(s) as being produced when the named target is produced.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register_dependency_build-instance_method" title="#register_dependency_build (instance method)">#<strong>register_dependency_build</strong>(target, source, suffix, vars, builder_class)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Register a builder to build a source file into an output with the given suffix.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register_side_effect-instance_method" title="#register_side_effect (instance method)">#<strong>register_side_effect</strong>(side_effect)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>Register a side effect file.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="BasicEnvironment.html" title="Rscons::BasicEnvironment (class)">BasicEnvironment</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="BasicEnvironment.html#[]-instance_method" title="Rscons::BasicEnvironment#[] (method)">#[]</a></span>, <span class='object_link'><a href="BasicEnvironment.html#[]=-instance_method" title="Rscons::BasicEnvironment#[]= (method)">#[]=</a></span>, <span class='object_link'><a href="BasicEnvironment.html#append-instance_method" title="Rscons::BasicEnvironment#append (method)">#append</a></span>, <span class='object_link'><a href="BasicEnvironment.html#apply_configuration_data!-instance_method" title="Rscons::BasicEnvironment#apply_configuration_data! (method)">#apply_configuration_data!</a></span>, <span class='object_link'><a href="BasicEnvironment.html#dump-instance_method" title="Rscons::BasicEnvironment#dump (method)">#dump</a></span>, <span class='object_link'><a href="BasicEnvironment.html#expand_varref-instance_method" title="Rscons::BasicEnvironment#expand_varref (method)">#expand_varref</a></span>, <span class='object_link'><a href="BasicEnvironment.html#get_var-instance_method" title="Rscons::BasicEnvironment#get_var (method)">#get_var</a></span>, <span class='object_link'><a href="BasicEnvironment.html#load_configuration_data!-instance_method" title="Rscons::BasicEnvironment#load_configuration_data! (method)">#load_configuration_data!</a></span>, <span class='object_link'><a href="BasicEnvironment.html#merge_flags-instance_method" title="Rscons::BasicEnvironment#merge_flags (method)">#merge_flags</a></span>, <span class='object_link'><a href="BasicEnvironment.html#parse_flags-instance_method" title="Rscons::BasicEnvironment#parse_flags (method)">#parse_flags</a></span>, <span class='object_link'><a href="BasicEnvironment.html#parse_flags!-instance_method" title="Rscons::BasicEnvironment#parse_flags! (method)">#parse_flags!</a></span>, <span class='object_link'><a href="BasicEnvironment.html#shell-instance_method" title="Rscons::BasicEnvironment#shell (method)">#shell</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(options = {})  &#x21d2; <tt><span class='object_link'><a href="" title="Rscons::Environment (class)">Environment</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create an Environment object.</p>

<p>If a block is given, the Environment object is yielded to the block and when the block returns, the <span class='object_link'><a href="#process-instance_method" title="Rscons::Environment#process (method)">#process</a></span> method is automatically called.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:echo</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>:command, :short, or :off (default :short)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:exclude_builders</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Whether to omit adding default builders (default false)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:use</span>
          <span class="type">(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use flag(s). If specified, any configuration flags which were saved with a corresponding `:use` value will be applied to this Environment.</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 68</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="Cache.html" title="Rscons::Cache (class)">Cache</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'><span class='object_link'><a href="Cache.html#instance-class_method" title="Rscons::Cache.instance (method)">instance</a></span></span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>configuration_data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>configured</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Project must be configured before creating an Environment</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='ivar'>@id</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_get_id'>get_id</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_register'>register</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='comment'># Hash of Thread object =&gt; {Command} or {Builder}.
</span>  <span class='ivar'>@threads</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@registered_build_dependencies</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='comment'># Set of side-effect files that have not yet been built.
</span>  <span class='ivar'>@side_effects</span> <span class='op'>=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='ivar'>@builder_sets</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@build_targets</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@user_deps</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='comment'># Hash of builder name (String) =&gt; builder class (Class).
</span>  <span class='ivar'>@builders</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@build_hooks</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>pre:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>post:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exclude_builders</span><span class='rbracket'>]</span>
    <span class='const'><span class='object_link'><a href="../Rscons.html#DEFAULT_BUILDERS-constant" title="Rscons::DEFAULT_BUILDERS (constant)">DEFAULT_BUILDERS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_builder_class_name'>builder_class_name</span><span class='op'>|</span>
      <span class='id identifier rubyid_builder_class'>builder_class</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Builders.html" title="Rscons::Builders (module)">Builders</a></span></span><span class='period'>.</span><span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='id identifier rubyid_builder_class_name'>builder_class_name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_builder_class'>builder_class</span> <span class='kw'>or</span> <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find builder class </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_builder_class_name'>builder_class_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_add_builder'>add_builder</span><span class='lparen'>(</span><span class='id identifier rubyid_builder_class'>builder_class</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='ivar'>@echo</span> <span class='op'>=</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:echo</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:echo</span><span class='rbracket'>]</span>
    <span class='kw'>elsif</span> <span class='const'><span class='object_link'><a href="../Rscons.html" title="Rscons (module)">Rscons</a></span></span><span class='period'>.</span><span class='id identifier rubyid_application'><span class='object_link'><a href="../Rscons.html#application-class_method" title="Rscons.application (method)">application</a></span></span><span class='period'>.</span><span class='id identifier rubyid_verbose'><span class='object_link'><a href="Application.html#verbose-instance_method" title="Rscons::Application#verbose (method)">verbose</a></span></span>
      <span class='symbol'>:command</span>
    <span class='kw'>else</span>
      <span class='symbol'>:short</span>
    <span class='kw'>end</span>
  <span class='ivar'>@build_root</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="Cache.html" title="Rscons::Cache (class)">Cache</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'><span class='object_link'><a href="Cache.html#instance-class_method" title="Rscons::Cache.instance (method)">instance</a></span></span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>configuration_data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>build_dir</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>/e.</span><span class='embexpr_beg'>#{</span><span class='ivar'>@id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@n_threads</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Rscons.html" title="Rscons (module)">Rscons</a></span></span><span class='period'>.</span><span class='id identifier rubyid_application'><span class='object_link'><a href="../Rscons.html#application-class_method" title="Rscons.application (method)">application</a></span></span><span class='period'>.</span><span class='id identifier rubyid_n_threads'><span class='object_link'><a href="Application.html#n_threads-instance_method" title="Rscons::Application#n_threads (method)">n_threads</a></span></span>

  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>yield</span> <span class='kw'>self</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>
<div id="method_missing_details" class="method_details_list">
  <h2>Dynamic Method Handling</h2>
  <p class="notice this">
    This class handles dynamic methods through the <tt>method_missing</tt> method
    
  </p>
  
    <div class="method_details first">
  <h3 class="signature first" id="method_missing-instance_method">
  
    #<strong>method_missing</strong>(method, *args)  &#x21d2; <tt><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Define a build target.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>method</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Method name.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Method arguments.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The <span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span> object registered, if the method called is the name of a registered <span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span>.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 311</span>

<span class='kw'>def</span> <span class='id identifier rubyid_method_missing'>method_missing</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@builders</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_method'>method</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='id identifier rubyid_sources'>sources</span><span class='comma'>,</span> <span class='id identifier rubyid_vars'>vars</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_rest'>rest</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>
    <span class='id identifier rubyid_vars'>vars</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_vars'>vars</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span> <span class='kw'>or</span> <span class='id identifier rubyid_vars'>vars</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="VarSet.html" title="Rscons::VarSet (class)">VarSet</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unexpected construction variable set: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_vars'>vars</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_expand_varref'>expand_varref</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sources'>sources</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_sources'>sources</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_source'>source</span><span class='op'>|</span>
      <span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='id identifier rubyid_source'>source</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span> <span class='kw'>if</span> <span class='id identifier rubyid_source'>source</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_expand_varref'>expand_varref</span><span class='lparen'>(</span><span class='id identifier rubyid_source'>source</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
    <span class='id identifier rubyid_builder'>builder</span> <span class='op'>=</span> <span class='ivar'>@builders</span><span class='lbracket'>[</span><span class='id identifier rubyid_method'>method</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
      <span class='label'>target:</span> <span class='id identifier rubyid_target'>target</span><span class='comma'>,</span>
      <span class='label'>sources:</span> <span class='id identifier rubyid_sources'>sources</span><span class='comma'>,</span>
      <span class='label'>cache:</span> <span class='const'><span class='object_link'><a href="Cache.html" title="Rscons::Cache (class)">Cache</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'><span class='object_link'><a href="Cache.html#instance-class_method" title="Rscons::Cache.instance (method)">instance</a></span></span><span class='comma'>,</span>
      <span class='label'>env:</span> <span class='kw'>self</span><span class='comma'>,</span>
      <span class='label'>vars:</span> <span class='id identifier rubyid_vars'>vars</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='ivar'>@builder_sets</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='ivar'>@builder_sets</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_build_builder_set'>build_builder_set</span>
    <span class='kw'>end</span>
    <span class='ivar'>@builder_sets</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_builder'>builder</span>
    <span class='ivar'>@build_targets</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_builder'>builder</span>
    <span class='id identifier rubyid_builder'>builder</span>
  <span class='kw'>else</span>
    <span class='kw'>super</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="class_attr_details" class="attr_details">
    <h2>Class Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="environments-class_method">
  
    .<strong>environments</strong>  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="" title="Rscons::Environment (class)">Environment</a></span>&gt;</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns All Environments.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="" title="Rscons::Environment (class)">Environment</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>All Environments.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 16</span>

<span class='kw'>def</span> <span class='id identifier rubyid_environments'>environments</span>
  <span class='ivar'>@environments</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="build_root-instance_method">
  
    #<strong>build_root</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The build root.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The build root.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 48</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_root'>build_root</span>
  <span class='ivar'>@build_root</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="builders-instance_method">
  
    #<strong>builders</strong>  &#x21d2; <tt>Hash</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns Set of {“builder_name” =&gt; builder_object} pairs.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Set of {“builder_name” =&gt; builder_object} pairs.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


42
43
44</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 42</span>

<span class='kw'>def</span> <span class='id identifier rubyid_builders'>builders</span>
  <span class='ivar'>@builders</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="echo=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="echo-instance_method">
  
    #<strong>echo</strong>  &#x21d2; <tt>Symbol</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns :command, :short, or :off</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>:command, :short, or :off</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 45</span>

<span class='kw'>def</span> <span class='id identifier rubyid_echo'>echo</span>
  <span class='ivar'>@echo</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="n_threads=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="n_threads-instance_method">
  
    #<strong>n_threads</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The number of threads to use for this Environment. Defaults to the global Rscons.application.n_threads value.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of threads to use for this Environment. Defaults to the global Rscons.application.n_threads value.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 53</span>

<span class='kw'>def</span> <span class='id identifier rubyid_n_threads'>n_threads</span>
  <span class='ivar'>@n_threads</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="class_init-class_method">
  
    .<strong>class_init</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Initialize class instance variables.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 19</span>

<span class='kw'>def</span> <span class='id identifier rubyid_class_init'>class_init</span>
  <span class='ivar'>@environments</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_id-class_method">
  
    .<strong>get_id</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get an ID for a new Environment. This is a monotonically increasing integer.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Environment ID.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


28
29
30
31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 28</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_id'>get_id</span>
  <span class='ivar'>@id</span> <span class='op'>||=</span> <span class='int'>0</span>
  <span class='ivar'>@id</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='ivar'>@id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="register-class_method">
  
    .<strong>register</strong>(env)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Register an Environment.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37
38</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 35</span>

<span class='kw'>def</span> <span class='id identifier rubyid_register'>register</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='ivar'>@environments</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@environments</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_env'>env</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_build_hook-instance_method">
  
    #<strong>add_build_hook</strong> {|build_op| ... } &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Add a build hook to the Environment.</p>

<p>Build hooks are Ruby blocks which are invoked immediately before a build operation takes place. Build hooks have an opportunity to modify the construction variables in use for the build operation based on the builder in use, target file name, or sources. Build hooks can also register new build targets.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>build_op</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Invoke the given block with the current build operation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>build_op</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Hash with keys:</p>
<ul><li>
<p>:builder - The builder object in use.</p>
</li><li>
<p>:target - Target file name.</p>
</li><li>
<p>:sources - List of source file(s).</p>
</li><li>
<p>:vars - Set of construction variable values in use.</p>
</li><li>
<p>:env - The Environment invoking the builder.</p>
</li></ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


210
211
212</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 210</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_build_hook'>add_build_hook</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@build_hooks</span><span class='lbracket'>[</span><span class='symbol'>:pre</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_builder-instance_method">
  
    
      <span class="overload">#<strong>add_builder</strong>(builder_class)  &#x21d2; <tt>void</tt> </span>
    
      <span class="overload">#<strong>add_builder</strong>(name, &amp;action)  &#x21d2; <tt>void</tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Add a <span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span> to the Environment.</p>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>add_builder</strong>(builder_class)  &#x21d2; <tt>void</tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Add the given builder to the Environment.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>builder_class</span>
      
      
        <span class='type'>(<tt>Class</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A builder class to register.</p>
</div>
      
    </li>
  
</ul>


</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>add_builder</strong>(name, &amp;action)  &#x21d2; <tt>void</tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Create a new <span class='object_link'><a href="Builders/SimpleBuilder.html" title="Rscons::Builders::SimpleBuilder (class)">Builders::SimpleBuilder</a></span> instance and add it to the environment.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the builder to add.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>action</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A block that will be called when the builder is executed to generate a target file. The provided block should have the same prototype as <span class='object_link'><a href="Builder.html#run-instance_method" title="Rscons::Builder#run (method)">Builder#run</a></span>.</p>
</div>
      
    </li>
  
</ul>


</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


181
182
183
184
185
186
187
188
189</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 181</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_builder'>add_builder</span><span class='lparen'>(</span><span class='id identifier rubyid_builder_class'>builder_class</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_action'>action</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_builder_class'>builder_class</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span> <span class='kw'>or</span> <span class='id identifier rubyid_builder_class'>builder_class</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Symbol</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_builder_class'>builder_class</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_builder_class'>builder_class</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="BuilderBuilder.html" title="Rscons::BuilderBuilder (class)">BuilderBuilder</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="BuilderBuilder.html#new-instance_method" title="Rscons::BuilderBuilder#new (method)">new</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Rscons.html" title="Rscons (module)">Rscons</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Builders.html" title="Rscons::Builders (module)">Builders</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Builders/SimpleBuilder.html" title="Rscons::Builders::SimpleBuilder (class)">SimpleBuilder</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_action'>action</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_builder_class'>builder_class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='kw'>end</span>
  <span class='ivar'>@builders</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_builder_class'>builder_class</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_post_build_hook-instance_method">
  
    #<strong>add_post_build_hook</strong> {|build_op| ... } &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Add a post build hook to the Environment.</p>

<p>Post-build hooks are Ruby blocks which are invoked immediately after a build operation takes place. Post-build hooks are only invoked if the build operation succeeded. Post-build hooks can register new build targets.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>build_op</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Invoke the given block with the current build operation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>build_op</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Hash with keys:</p>
<ul><li>
<p>:builder - The builder object in use.</p>
</li><li>
<p>:target - Target file name.</p>
</li><li>
<p>:sources - List of source file(s).</p>
</li><li>
<p>:vars - Set of construction variable values in use.</p>
</li><li>
<p>:env - The Environment invoking the builder.</p>
</li></ul>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 232</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_post_build_hook'>add_post_build_hook</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@build_hooks</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="barrier-instance_method">
  
    #<strong>barrier</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Mark a “barrier” point.</p>

<p>Rscons will wait for all build targets registered before the barrier to be built before beginning to build any build targets registered after the barrier. In other words, Rscons will not parallelize build operations across a barrier.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


539
540
541</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 539</span>

<span class='kw'>def</span> <span class='id identifier rubyid_barrier'>barrier</span>
  <span class='ivar'>@builder_sets</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_build_builder_set'>build_builder_set</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build_after-instance_method">
  
    #<strong>build_after</strong>(targets, prerequisites)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Manually record the given target(s) as needing to be built after the given prerequisite(s).</p>

<p>For example, consider a builder registered to generate gen.c which also generates gen.h as a side-effect. If program.c includes gen.h, then it should not be compiled before gen.h has been generated. When using multiple threads to build, Rscons may attempt to compile program.c before gen.h has been generated because it does not know that gen.h will be generated along with gen.c. One way to prevent that situation would be to first process the Environment with just the code-generation builders in place and then register the compilation builders. Another way is to use this method to record that a certain target should not be built until another has completed. For example, for the situation previously described:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_build_after'>build_after</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>program.o</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gen.c</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>targets</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Target files to wait to build until the prerequisites are finished building.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>prerequisites</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></tt>, <tt>Array&lt;String, <span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Files that must be built before building the specified targets.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


385
386
387
388
389
390
391
392
393
394
395
396
397
398
399</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 385</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_after'>build_after</span><span class='lparen'>(</span><span class='id identifier rubyid_targets'>targets</span><span class='comma'>,</span> <span class='id identifier rubyid_prerequisites'>prerequisites</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_targets'>targets</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_targets'>targets</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_prerequisites'>prerequisites</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_prerequisites'>prerequisites</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_targets'>targets</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_target'>target</span><span class='op'>|</span>
    <span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_expand_varref'>expand_varref</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='ivar'>@registered_build_dependencies</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_prerequisites'>prerequisites</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_prerequisite'>prerequisite</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_prerequisite'>prerequisite</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_prerequisite'>prerequisite</span> <span class='op'>=</span> <span class='id identifier rubyid_prerequisite'>prerequisite</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_prerequisite'>prerequisite</span> <span class='op'>=</span> <span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_expand_varref'>expand_varref</span><span class='lparen'>(</span><span class='id identifier rubyid_prerequisite'>prerequisite</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='ivar'>@registered_build_dependencies</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_prerequisite'>prerequisite</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build_steps_remaining-instance_method">
  
    #<strong>build_steps_remaining</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the number of build steps remaining.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of build steps remaining.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


547
548
549
550
551</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 547</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_steps_remaining'>build_steps_remaining</span>
  <span class='ivar'>@builder_sets</span><span class='period'>.</span><span class='id identifier rubyid_reduce'>reduce</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_builder_set'>builder_set</span><span class='op'>|</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>+</span> <span class='id identifier rubyid_builder_set'>builder_set</span><span class='period'>.</span><span class='id identifier rubyid_build_steps_remaining'>build_steps_remaining</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="builder_for-instance_method">
  
    #<strong>builder_for</strong>(target)  &#x21d2; <tt><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the Builder for a target.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The <span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span> for target, or <code>nil</code> if none found.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


529
530
531</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 529</span>

<span class='kw'>def</span> <span class='id identifier rubyid_builder_for'>builder_for</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
  <span class='ivar'>@build_targets</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="clear_targets-instance_method">
  
    #<strong>clear_targets</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Clear all targets registered for the Environment.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


299
300
301</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 299</span>

<span class='kw'>def</span> <span class='id identifier rubyid_clear_targets'>clear_targets</span>
  <span class='ivar'>@builder_sets</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="clone-instance_method">
  
    #<strong>clone</strong>(options = {})  &#x21d2; <tt><span class='object_link'><a href="" title="Rscons::Environment (class)">Environment</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Make a copy of the Environment object.</p>

<p>By default, a cloned environment will contain a copy of all environment options, construction variables, and builders, but not a copy of the targets, build hooks, build directories, or the build root.</p>

<p>Exactly which items are cloned are controllable via the optional :clone parameter, which can be :none, :all, or a set or array of any of the following:</p>
<ul><li>
<p>:variables to clone construction variables (on by default)</p>
</li><li>
<p>:builders to clone the builders (on by default)</p>
</li><li>
<p>:build_hooks to clone the build hooks (on by default)</p>
</li></ul>

<p>If a block is given, the Environment object is yielded to the block and when the block returns, the <span class='object_link'><a href="#process-instance_method" title="Rscons::Environment#process (method)">#process</a></span> method is automatically called.</p>

<p>Any options that #initialize receives can also be specified here.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Rscons::Environment (class)">Environment</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The newly created <span class='object_link'><a href="" title="Rscons::Environment (class)">Rscons::Environment</a></span> object.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 128</span>

<span class='kw'>def</span> <span class='id identifier rubyid_clone'>clone</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_clone'>clone</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:clone</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='symbol'>:all</span>
  <span class='id identifier rubyid_clone'>clone</span> <span class='op'>=</span> <span class='const'>Set</span><span class='lbracket'>[</span><span class='symbol'>:variables</span><span class='comma'>,</span> <span class='symbol'>:builders</span><span class='comma'>,</span> <span class='symbol'>:build_hooks</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_clone'>clone</span> <span class='op'>==</span> <span class='symbol'>:all</span>
  <span class='id identifier rubyid_clone'>clone</span> <span class='op'>=</span> <span class='const'>Set</span><span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_clone'>clone</span> <span class='op'>==</span> <span class='symbol'>:none</span>
  <span class='id identifier rubyid_clone'>clone</span> <span class='op'>=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_clone'>clone</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_clone'>clone</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_clone'>clone</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:builders</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exclude_builders</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='label'>echo:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:echo</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='ivar'>@echo</span><span class='comma'>,</span>
    <span class='label'>exclude_builders:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_clone'>clone</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:builders</span><span class='rparen'>)</span>
    <span class='ivar'>@builders</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_builder_name'>builder_name</span><span class='comma'>,</span> <span class='id identifier rubyid_builder'>builder</span><span class='op'>|</span>
      <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_add_builder'>add_builder</span><span class='lparen'>(</span><span class='id identifier rubyid_builder'>builder</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='ivar'>@varset</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_clone'>clone</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:variables</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_clone'>clone</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:build_hooks</span><span class='rparen'>)</span>
    <span class='ivar'>@build_hooks</span><span class='lbracket'>[</span><span class='symbol'>:pre</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_build_hook_block'>build_hook_block</span><span class='op'>|</span>
      <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_add_build_hook'>add_build_hook</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_build_hook_block'>build_hook_block</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='ivar'>@build_hooks</span><span class='lbracket'>[</span><span class='symbol'>:post</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_build_hook_block'>build_hook_block</span><span class='op'>|</span>
      <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_add_post_build_hook'>add_post_build_hook</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_build_hook_block'>build_hook_block</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='symbol'>:@n_threads</span><span class='comma'>,</span> <span class='ivar'>@n_threads</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_env'>env</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_env'>env</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="depends-instance_method">
  
    #<strong>depends</strong>(target, *user_deps)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Manually record a given target as depending on the specified files.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Target file.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>user_deps</span>
      
      
        <span class='type'>(<tt>Array&lt;String, <span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Dependency files.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


346
347
348
349
350
351
352
353
354
355
356
357
358
359
360</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 346</span>

<span class='kw'>def</span> <span class='id identifier rubyid_depends'>depends</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_user_deps'>user_deps</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='id identifier rubyid_expand_varref'>expand_varref</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_user_deps'>user_deps</span> <span class='op'>=</span> <span class='id identifier rubyid_user_deps'>user_deps</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ud'>ud</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_ud'>ud</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_ud'>ud</span> <span class='op'>=</span> <span class='id identifier rubyid_ud'>ud</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_expand_varref'>expand_varref</span><span class='lparen'>(</span><span class='id identifier rubyid_ud'>ud</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='ivar'>@user_deps</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@user_deps</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='ivar'>@user_deps</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_user_deps'>user_deps</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
  <span class='id identifier rubyid_build_after'>build_after</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='id identifier rubyid_user_deps'>user_deps</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="expand_path-instance_method">
  
    #<strong>expand_path</strong>(path)  &#x21d2; <tt>String</tt><sup>+</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Expand a path to be relative to the Environment&#39;s build root.</p>

<p>Paths beginning with “^/” are expanded by replacing “^” with the Environment&#39;s build root.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The path(s) to expand.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The expanded path(s).</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


481
482
483
484
485
486
487
488
489
490
491</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 481</span>

<span class='kw'>def</span> <span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../Rscons.html" title="Rscons (module)">Rscons</a></span></span><span class='period'>.</span><span class='id identifier rubyid_phony_target?'><span class='object_link'><a href="../Rscons.html#phony_target%3F-class_method" title="Rscons.phony_target? (method)">phony_target?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_path'>path</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='op'>|</span>
      <span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>^\^(?=[\\/])</span><span class='regexp_end'>}</span></span><span class='comma'>,</span> <span class='ivar'>@build_root</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_build_fname-instance_method">
  
    #<strong>get_build_fname</strong>(source_fname, suffix, builder_class)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return the file name to be built from <code>source_fname</code> with suffix <code>suffix</code>.</p>

<p>This method takes into account the Environment&#39;s build directories.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>source_fname</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Source file name.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Suffix, including “.” if desired.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>builder_class</span>
      
      
        <span class='type'>(<tt>Class</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The builder in use.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The file name to be built from <code>source_fname</code> with suffix <code>suffix</code>.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


250
251
252
253
254
255</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 250</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_build_fname'>get_build_fname</span><span class='lparen'>(</span><span class='id identifier rubyid_source_fname'>source_fname</span><span class='comma'>,</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='comma'>,</span> <span class='id identifier rubyid_builder_class'>builder_class</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_extra_path'>extra_path</span> <span class='op'>=</span> <span class='id identifier rubyid_builder_class'>builder_class</span><span class='period'>.</span><span class='id identifier rubyid_extra_path'>extra_path</span>
    <span class='id identifier rubyid_extra_path'>extra_path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_extra_path'>extra_path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@build_root</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_extra_path'>extra_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="Util.html" title="Rscons::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_make_relative_path'><span class='object_link'><a href="Util.html#make_relative_path-class_method" title="Rscons::Util.make_relative_path (method)">make_relative_path</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Rscons.html" title="Rscons (module)">Rscons</a></span></span><span class='period'>.</span><span class='id identifier rubyid_set_suffix'><span class='object_link'><a href="../Rscons.html#set_suffix-class_method" title="Rscons.set_suffix (method)">set_suffix</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_source_fname'>source_fname</span><span class='comma'>,</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_user_deps-instance_method">
  
    #<strong>get_user_deps</strong>(target)  &#x21d2; <tt>Array&lt;String&gt;</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return the list of user dependencies for a given target.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Target file name.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>List of user-specified dependencies for the target, or nil if none were specified.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


440
441
442</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 440</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_user_deps'>get_user_deps</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
  <span class='ivar'>@user_deps</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_builder_run_message-instance_method">
  
    #<strong>print_builder_run_message</strong>(builder, short_description, command)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Print the builder run message, depending on the Environment&#39;s echo mode.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>builder</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The <span class='object_link'><a href="Builder.html" title="Rscons::Builder (class)">Builder</a></span> that is executing.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>short_description</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Builder short description, printed if the echo mode is :short, or if there is no command.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>command</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Builder command, printed if the echo mode is :command.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 504</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_builder_run_message'>print_builder_run_message</span><span class='lparen'>(</span><span class='id identifier rubyid_builder'>builder</span><span class='comma'>,</span> <span class='id identifier rubyid_short_description'>short_description</span><span class='comma'>,</span> <span class='id identifier rubyid_command'>command</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='ivar'>@echo</span>
  <span class='kw'>when</span> <span class='symbol'>:command</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_command'>command</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Util.html" title="Rscons::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_command_to_s'><span class='object_link'><a href="Util.html#command_to_s-class_method" title="Rscons::Util.command_to_s (method)">command_to_s</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_command'>command</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_command'>command</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_command'>command</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_short_description'>short_description</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_short_description'>short_description</span>
    <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='symbol'>:short</span>
    <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_short_description'>short_description</span> <span class='kw'>if</span> <span class='id identifier rubyid_short_description'>short_description</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_message'>message</span>
    <span class='id identifier rubyid_total_build_steps'>total_build_steps</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Rscons.html" title="Rscons (module)">Rscons</a></span></span><span class='period'>.</span><span class='id identifier rubyid_application'><span class='object_link'><a href="../Rscons.html#application-class_method" title="Rscons.application (method)">application</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_total_build_steps'><span class='object_link'><a href="Application.html#get_total_build_steps-instance_method" title="Rscons::Application#get_total_build_steps (method)">get_total_build_steps</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_this_build_step'>this_build_step</span> <span class='op'>=</span> <span class='id identifier rubyid_sprintf'>sprintf</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_total_build_steps'>total_build_steps</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'>d</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_build_step'>build_step</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_progress'>progress</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_this_build_step'>this_build_step</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_total_build_steps'>total_build_steps</span><span class='embexpr_end'>}</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'><span class='object_link'><a href="Ansi.html" title="Rscons::Ansi (module)">Ansi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_write'><span class='object_link'><a href="Ansi.html#write-class_method" title="Rscons::Ansi.write (method)">write</a></span></span><span class='lparen'>(</span><span class='gvar'>$stdout</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="Util.html" title="Rscons::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_colorize_markup'><span class='object_link'><a href="Util.html#colorize_markup-class_method" title="Rscons::Util.colorize_markup (method)">colorize_markup</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_progress'>progress</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process-instance_method">
  
    #<strong>process</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Build all build targets specified in the Environment.</p>

<p>When a block is passed to Environment.new, this method is automatically called after the block returns.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 263</span>

<span class='kw'>def</span> <span class='id identifier rubyid_process'>process</span>
  <span class='const'><span class='object_link'><a href="Cache.html" title="Rscons::Cache (class)">Cache</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'><span class='object_link'><a href="Cache.html#instance-class_method" title="Rscons::Cache.instance (method)">instance</a></span></span><span class='period'>.</span><span class='id identifier rubyid_clear_checksum_cache!'>clear_checksum_cache!</span>
  <span class='ivar'>@process_failures</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@process_blocking_wait</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@process_commands_waiting_to_run</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@process_builder_waits</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@process_builders_to_run</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>begin</span>
    <span class='kw'>while</span> <span class='ivar'>@builder_sets</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='kw'>or</span> <span class='ivar'>@threads</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='kw'>or</span> <span class='ivar'>@process_commands_waiting_to_run</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>0</span>
      <span class='id identifier rubyid_process_step'>process_step</span>
      <span class='kw'>if</span> <span class='ivar'>@builder_sets</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='ivar'>@builder_sets</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>and</span> <span class='ivar'>@threads</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>and</span> <span class='ivar'>@process_commands_waiting_to_run</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>and</span> <span class='ivar'>@process_builders_to_run</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='comment'># Remove empty BuilderSet when all other operations have completed.
</span>        <span class='ivar'>@builder_sets</span><span class='period'>.</span><span class='id identifier rubyid_slice!'>slice!</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='kw'>unless</span> <span class='ivar'>@process_failures</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='comment'># On a build failure, do not start any more builders or commands,
</span>        <span class='comment'># but let the threads that have already been started complete.
</span>        <span class='ivar'>@builder_sets</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
        <span class='ivar'>@process_commands_waiting_to_run</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>ensure</span>
    <span class='const'><span class='object_link'><a href="Cache.html" title="Rscons::Cache (class)">Cache</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'><span class='object_link'><a href="Cache.html#instance-class_method" title="Rscons::Cache.instance (method)">instance</a></span></span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span>
  <span class='kw'>end</span>
  <span class='kw'>unless</span> <span class='ivar'>@process_failures</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='ivar'>@process_failures</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="Cache.html" title="Rscons::Cache (class)">Cache</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'><span class='object_link'><a href="Cache.html#instance-class_method" title="Rscons::Cache.instance (method)">instance</a></span></span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>failed_commands</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>0</span>
      <span class='id identifier rubyid_msg'>msg</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\nUse -F to view the failed command log from the previous build operation</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="BuildError.html" title="Rscons::BuildError (class)">BuildError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="produces-instance_method">
  
    #<strong>produces</strong>(target, *side_effects)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Manually record the given side effect file(s) as being produced when the named target is produced.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Target of a build operation.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>side_effects</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>File(s) produced when the target file is produced.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


410
411
412
413
414
415
416
417
418
419</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 410</span>

<span class='kw'>def</span> <span class='id identifier rubyid_produces'>produces</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_side_effects'>side_effects</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_expand_varref'>expand_varref</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='ivar'>@builder_sets</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_builder_set'>builder_set</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_builders'>builders</span> <span class='op'>=</span> <span class='id identifier rubyid_builder_set'>builder_set</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_builders'>builders</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_produces'>produces</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_side_effects'>side_effects</span><span class='rparen'>)</span>
      <span class='kw'>return</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find a registered build target </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="register_dependency_build-instance_method">
  
    #<strong>register_dependency_build</strong>(target, source, suffix, vars, builder_class)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Register a builder to build a source file into an output with the given suffix.</p>

<p>This method is used internally by Rscons builders. It can be called from the builder&#39;s #initialize method.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The target that depends on these builds.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>source</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Source file to build.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Suffix to try to convert source files into.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>vars</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Extra variables to pass to the builders.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>builder_class</span>
      
      
        <span class='type'>(<tt>Class</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The builder class to use.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Output file name.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


463
464
465
466
467
468
469</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 463</span>

<span class='kw'>def</span> <span class='id identifier rubyid_register_dependency_build'>register_dependency_build</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='comma'>,</span> <span class='id identifier rubyid_vars'>vars</span><span class='comma'>,</span> <span class='id identifier rubyid_builder_class'>builder_class</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_output_fname'>output_fname</span> <span class='op'>=</span> <span class='id identifier rubyid_get_build_fname'>get_build_fname</span><span class='lparen'>(</span><span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='comma'>,</span> <span class='id identifier rubyid_builder_class'>builder_class</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid___send__'>__send__</span><span class='lparen'>(</span><span class='id identifier rubyid_builder_class'>builder_class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_output_fname'>output_fname</span><span class='comma'>,</span> <span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='id identifier rubyid_vars'>vars</span><span class='rparen'>)</span>
  <span class='ivar'>@registered_build_dependencies</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='ivar'>@registered_build_dependencies</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_output_fname'>output_fname</span>
  <span class='id identifier rubyid_output_fname'>output_fname</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="register_side_effect-instance_method">
  
    #<strong>register_side_effect</strong>(side_effect)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>Register a side effect file.</p>

<p>This is an internally used method.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>side_effect</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Side effect fiel name.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


429
430
431</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rscons/environment.rb', line 429</span>

<span class='kw'>def</span> <span class='id identifier rubyid_register_side_effect'>register_side_effect</span><span class='lparen'>(</span><span class='id identifier rubyid_side_effect'>side_effect</span><span class='rparen'>)</span>
  <span class='ivar'>@side_effects</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_side_effect'>side_effect</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Oct  2 21:12:03 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20 (ruby-2.5.5).
</div>

    </div>
  </body>
</html>